<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="
        default-src 'self'; 
        script-src 'self' https://cdnjs.cloudflare.com; 
        style-src 'self' https://cdnjs.cloudflare.com;
        img-src 'self' data: https:;
        font-src 'self' https://cdnjs.cloudflare.com;
        connect-src 'none';
        frame-src 'none';
        object-src 'none';
        base-uri 'self';
        form-action 'none';
    ">
    <meta name="referrer-policy" content="strict-origin-when-cross-origin">
    <meta http-equiv="Permissions-Policy" content="geolocation=(), microphone=(), camera=(), midi=(), encrypted-media=(), oversized-images=()">
    <title>Universal AI Chat Exporter</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/5.2.0/github-markdown-light.min.css" integrity="sha512-bm684OXnsiNuQSyrxuuwo4PHqr3OzxPpXyhT66DA/fhl73e1JmBxRKGnO/nRwWvOZxJLRCmNH7FII+Yn1JNPmg==" crossorigin="anonymous">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/11.1.1/marked.min.js" integrity="sha512-oSA0PdOBsyP4Cv5rIHOWhOr+H0ZPOE/L8UKaX33DjBFD+TrWOZZfewjg85Z7WhNPkQrHeTKOYSio/XM6FBPhWA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dompurify/3.0.8/purify.min.js" integrity="sha512-5g2Nj3mqLOgClHi20oat1COW7jWvf7SyqnvwWUsMDwhjHeqeTl0C+uzjucLweruQxHbhDwiPLXlm8HBO0011pA==" crossorigin="anonymous"></script>
</head>
<body>

<header role="banner">
    <div class="brand">
        <svg fill="none" stroke="currentColor" stroke-width="2" width="24" height="24" viewBox="0 0 24 24" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"></path>
        </svg>
        <span>AI Chat Exporter</span>
    </div>
    <div class="header-center">
        <div class="status" id="saveStatus"></div>
        <img src="https://visitor-badge.glitch.me/badge?page_id=octocat.github.io.main-site" alt="Visitor Count">
    </div>
    <div class="controls" role="navigation" aria-label="Main controls">
        <button type="button" class="btn" id="btnLoad" aria-label="Load saved draft">Load</button>
        <button type="button" class="btn" id="btnThemeLight" aria-label="Switch to light theme">Light</button>
        <button type="button" class="btn" id="btnThemeDark" aria-label="Switch to dark theme">Dark Mode</button>
        <button type="button" class="btn" id="btnThemeCycle" aria-label="Cycle to next theme">Cycle Theme</button>
        <button type="button" class="btn btn-success" id="btnSave" aria-label="Save current draft">Save</button>
        <button type="button" class="btn" id="btnClear" aria-label="Clear all content">Clear</button>
        <button type="button" class="btn btn-print" id="btnPrint" aria-label="Print or export to PDF">Export PDF</button>
    </div>
</header>

<main role="main">
<div class="workspace">
    <div class="editor-pane">
        <div class="pane-header">
            <span>Input (Markdown/Text)</span>
            <span class="char-count" id="charCount">0 chars</span>
        </div>
        <div class="pane-sub-header">
            <button type="button" class="btn" id="btnPaste">Paste Copied Text</button>
            <div class="instructions-box">
                <strong>Instructions:</strong>
                <ol>
                    <li>Paste your chat conversation into the text area below.</li>
                    <li>The app will automatically format it into chat bubbles.</li>
                    <li>Edit the Title, Date, and Source fields in the preview.</li>
                    <li>Use the "Export PDF" button to save your chat.</li>
                </ol>
                <div class="privacy-note">
                    <strong class="privacy-note-title">Privacy & Security Note:</strong> All data is stored locally in your browser's <code>localStorage</code>.
                    This means it could be accessed by other browser extensions or if another page on this same domain had a security issue.
                    For sensitive conversations, please use the "Clear" button to erase all data when you are finished. Your data is never sent to a server by this application.
                </div>
            </div>
        </div>
        <textarea 
            id="inputBox" 
            placeholder="Paste your conversation here.&#10;&#10;The tool will auto-detect speakers if lines start with:&#10;'User:', 'You', 'AI:', 'ChatGPT', 'Claude', etc."
            spellcheck="false"
            autocomplete="off"
        ></textarea>
    </div>

    <div class="preview-pane">
        <div id="document-sheet">
            <div class="doc-header">
                <div contenteditable="true" class="editable doc-title" id="docTitle" aria-label="Document Title" role="textbox">Enter Title Here</div>
                <div class="meta-row">
                    <span>Date: <input type="text" class="editable meta-input" id="dateField" value="Enter Date Here" autocomplete="off" aria-label="Document Date"></span>
                    <span>Source: <input type="text" class="editable meta-input" id="sourceField" value="Enter Source Here" autocomplete="off" aria-label="Conversation Source"></span>
                </div>
            </div>

            <div id="outputContent">
                <p class="preview-placeholder">Preview will appear here...</p>
            </div>
        </div>
    </div>
</div>
</main>

<div class="toast" id="toast"></div>

<script src="app.js" defer></script>

</body>
</html>
